{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="relative min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-blue-100 overflow-hidden">

  <!-- Background Blobs -->
  <div class="absolute top-[-150px] left-[-150px] w-[400px] h-[400px] bg-blue-200 rounded-full opacity-30 blur-3xl animate-pulse"></div>
  <div class="absolute bottom-[-150px] right-[-150px] w-[400px] h-[400px] bg-pink-200 rounded-full opacity-30 blur-3xl animate-pulse"></div>

  <!-- Signup Card -->
  <div class="relative bg-white bg-opacity-90 backdrop-blur-xl shadow-2xl rounded-3xl w-full max-w-md p-10">
    <h2 class="text-center text-3xl font-extrabold text-gray-900 mb-8">
      Create your account
    </h2>

    <form id="signupForm" class="space-y-6" action="{% url 'signup' %}" method="POST" novalidate>
      {% csrf_token %}

      <!-- Username -->
      <div class="relative">
        <input id="username" name="username" type="text" required
               class="peer w-full px-3 pt-5 pb-2 border border-gray-300 rounded-2xl shadow-sm placeholder-transparent focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 sm:text-sm transition-all"
               placeholder="Username" value="{{ form.username.value|default_if_none:'' }}">
        <label for="username" class="absolute left-3 top-2 text-gray-400 text-sm transition-all peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-gray-700 peer-focus:text-sm">Username</label>
        <p id="usernameError" class="mt-1 text-sm text-red-600 transition-opacity opacity-0"></p>
      </div>

      <!-- Email -->
      <div class="relative">
        <input id="email" name="email" type="email" required
               class="peer w-full px-3 pt-5 pb-2 border border-gray-300 rounded-2xl shadow-sm placeholder-transparent focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 sm:text-sm transition-all"
               placeholder="Email" value="{{ form.email.value|default_if_none:'' }}">
        <label for="email" class="absolute left-3 top-2 text-gray-400 text-sm transition-all peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-gray-700 peer-focus:text-sm">Email Address</label>
        <p id="emailError" class="mt-1 text-sm text-red-600 transition-opacity opacity-0"></p>
      </div>

      <!-- Account Type -->
      <div class="relative">
        <select id="user_type" name="user_type" required
                class="w-full px-3 py-2 border border-gray-300 rounded-2xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 sm:text-sm transition-all">
          <option value="">Select Account Type</option>
          <option value="user" {% if form.user_type.value == 'user' %}selected{% endif %}>Regular User</option>
          <option value="employee" {% if form.user_type.value == 'employee' %}selected{% endif %}>Employee</option>
          <option value="admin" {% if form.user_type.value == 'admin' %}selected{% endif %}>Administrator</option>
        </select>
        <p id="userTypeError" class="mt-1 text-sm text-red-600 transition-opacity opacity-0"></p>
      </div>


<!-- Password -->
      <div class="relative">
        <input id="password" name="password" type="password" required
               class="peer w-full px-3 pt-5 pb-2 border border-gray-300 rounded-2xl shadow-sm placeholder-transparent focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 sm:text-sm transition-all"
               placeholder="Password">
        <label for="password" class="absolute left-3 top-2 text-gray-400 text-sm transition-all peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-gray-700 peer-focus:text-sm">Password</label>
        <button type="button" class="absolute right-3 top-3 text-gray-500 font-medium text-sm toggle-password" data-target="password">
          <i class="fas fa-eye"></i>
        </button>
        <p id="passwordError" class="mt-1 text-sm text-red-600 transition-opacity opacity-0"></p>
      </div>

      <!-- Confirm Password -->
      <div class="relative">
        <input id="confirm_password" name="confirm_password" type="password" required
               class="peer w-full px-3 pt-5 pb-2 border border-gray-300 rounded-2xl shadow-sm placeholder-transparent focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 sm:text-sm transition-all"
               placeholder="Confirm Password">
        <label for="confirm_password" class="absolute left-3 top-2 text-gray-400 text-sm transition-all peer-placeholder-shown:top-5 peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-gray-700 peer-focus:text-sm">Confirm Password</label>
        <button type="button" class="absolute right-3 top-3 text-gray-500 font-medium text-sm toggle-password" data-target="confirm_password">
          <i class="fas fa-eye"></i>
        </button>
        <p id="confirmPasswordError" class="mt-1 text-sm text-red-600 transition-opacity opacity-0"></p>
      </div>

      <!-- Terms & Conditions -->
      <div class="flex items-center">
        <input id="terms" name="terms" type="checkbox" required 
               class="h-4 w-4 text-blue-600 focus:ring-blue-400 border-gray-300 rounded transition-all">
        <label for="terms" class="ml-2 text-sm text-gray-700">
          I agree to the <a href="#" class="text-blue-600 hover:text-blue-500 font-medium">Terms and Conditions</a>
        </label>
        <p id="termsError" class="mt-1 text-sm text-red-600 transition-opacity opacity-0"></p>
      </div>

      <!-- Submit Button -->
      <div>
        <button type="submit" class="w-full flex justify-center py-2 px-4 rounded-2xl shadow-lg text-white font-semibold text-sm bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-400">
          Create Account
        </button>
      </div>
    </form>

    <!-- Already have account -->
    <p class="mt-6 text-center text-sm text-gray-600">
      Already have an account? 
      <a href="{% url 'login' %}" class="font-medium text-blue-600 hover:text-blue-500">Sign in</a>
    </p>

    <!-- Divider -->
    <div class="mt-6 relative">
      <div class="absolute inset-0 flex items-center">
        <div class="w-full border-t border-gray-300"></div>
      </div>
      <div class="relative flex justify-center text-sm">
        <span class="px-2 bg-white text-gray-500">
          Or sign up with
        </span>
      </div>
    </div>


<!-- Social Signups -->
    <div class="mt-6 grid grid-cols-3 gap-3">
      <div>
        <a href="#" class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-2xl shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-blue-50 transition-all transform hover:scale-105">
          <i class="fab fa-facebook-f text-blue-600"></i>
        </a>
      </div>
      <div>
        <a href="#" class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-2xl shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-red-50 transition-all transform hover:scale-105">
          <i class="fab fa-google text-red-600"></i>
        </a>
      </div>
      <div>
        <a href="#" class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-2xl shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-blue-50 transition-all transform hover:scale-105">
          <i class="fab fa-linkedin-in text-blue-500"></i>
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  // Password toggle
  document.querySelectorAll('.toggle-password').forEach(btn => {
    btn.addEventListener('click', () => {
      const targetId = btn.getAttribute('data-target');
      const input = document.getElementById(targetId);
      if (input.type === 'password') {
        input.type = 'text';
        btn.innerHTML = '<i class="fas fa-eye-slash"></i>';
      } else {
        input.type = 'password';
        btn.innerHTML = '<i class="fas fa-eye"></i>';
      }
    });
  });

  // Inline validation
  document.getElementById('signupForm').addEventListener('submit', function(e) {
    let valid = true;
    ['username','email','userType','password','confirmPassword','terms'].forEach(id=>{
      const el = document.getElementById(id+'Error');
      if(el){ el.textContent=''; el.style.opacity='0'; }
    });

    const username = document.getElementById('username').value.trim();
    if(!username){ document.getElementById('usernameError').textContent='Username is required'; document.getElementById('usernameError').style.opacity='1'; valid=false; }

    const email = document.getElementById('email').value.trim();
    if(!email){ document.getElementById('emailError').textContent='Email is required'; document.getElementById('emailError').style.opacity='1'; valid=false; }
    else if(!/^\S+@\S+\.\S+$/.test(email)){ document.getElementById('emailError').textContent='Enter a valid email'; document.getElementById('emailError').style.opacity='1'; valid=false; }

    const userType = document.getElementById('user_type').value;
    if(!userType){ document.getElementById('userTypeError').textContent='Select account type'; document.getElementById('userTypeError').style.opacity='1'; valid=false; }

    const password = document.getElementById('password').value;
    if(!password){ document.getElementById('passwordError').textContent='Password is required'; document.getElementById('passwordError').style.opacity='1'; valid=false; }
    else if(password.length<6){ document.getElementById('passwordError').textContent='Password must be at least 6 characters'; document.getElementById('passwordError').style.opacity='1'; valid=false; }

    const confirmPassword = document.getElementById('confirm_password').value;
    if(!confirmPassword){ document.getElementById('confirmPasswordError').textContent='Please confirm your password'; document.getElementById('confirmPasswordError').style.opacity='1'; valid=false; }
    else if(confirmPassword!==password){ document.getElementById('confirmPasswordError').textContent='Passwords do not match'; document.getElementById('confirmPasswordError').style.opacity='1'; valid=false; }

    if(!document.getElementById('terms').checked){ document.getElementById('termsError').textContent='You must agree to the terms'; document.getElementById('termsError').style.opacity='1'; valid=false; }

    if(!valid) e.preventDefault();
  });
</script>
{% endblock %}